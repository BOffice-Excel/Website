<!DOCTYPE html>
<html>
    <head>
        <link rel="stylesheet" href="font-awesome-4.7.0\css\font-awesome.css">
        <title>Excel的个人主页</title>
        <script type="text/javascript" src="https://apps.bdimg.com/libs/jquery/2.1.4/jquery.min.js"></script>
        <style>
            .menu {
                /*border-image: linear-gradient(#e66465, #9198e5);*/
                border-right-style:solid;
                border-radius: 5px;
                position: fixed;
                top: 0px;
                left: 0px;
                height: 100%;
                width: 60px;
                background-color: white;
                z-index: 999;
            }
            .hide {
                display: none;
            }
        </style>
        <script>
            var is_dark_mode=false,Now_Src='MainPage.html';
            function DarkMode(){
                document.getElementById('menu').style.color='white';
                document.getElementById('menu').style.backgroundColor='black';
                document.getElementById('body').style.backgroundColor='black';
                document.getElementById('body').style.color='white';
            }
            function WhiteMode(){
                document.getElementById('menu').style.color='black';
                document.getElementById('menu').style.backgroundColor='white';
                document.getElementById('body').style.backgroundColor='white'; 
                document.getElementById('body').style.color='black';
            }
            function SwapMode(){
                if(!is_dark_mode){
                    $('#dark_mode').animate({left:'32px'},'fast');
                    document.getElementById('dark_mode_border').style.backgroundColor='black';
                    document.getElementById('dark_mode').style.backgroundColor='black';
                    DarkMode();
                    is_dark_mode=true;
                }
                else{
                    $('#dark_mode').animate({left:'2px'},'fast');
                    document.getElementById('dark_mode').style.backgroundColor='white';
                    document.getElementById('dark_mode_border').style.backgroundColor='gainsboro';
                    WhiteMode();
                    is_dark_mode=false;
                }
                SetURL();
            }
            function SwapSmile(){
                if(document.getElementById('menu').style.width!='230px'){
                    $('.menu').animate({width:'230px'},'fast');
                    document.getElementById('Bar_Text1').style.display='unset';
                    document.getElementById('Bar_Text2').style.display='unset';
                    document.getElementById('Bar_Text3').style.display='unset';
                    document.getElementById('Bar_Text4').style.display='unset';
                    document.getElementById('Bar_Text5').style.display='unset';
                }
                else{
                    $('.menu').animate({width:'60px'},'fast');
                    document.getElementById('Bar_Text1').style.display='none';
                    document.getElementById('Bar_Text2').style.display='none';
                    document.getElementById('Bar_Text3').style.display='none';
                    document.getElementById('Bar_Text4').style.display='none';
                    document.getElementById('Bar_Text5').style.display='none';
                }
            }
            function SetURL(){
                document.getElementById('Main').src=Now_Src+'?DarkMode='+(is_dark_mode?'true':'false'); 
            }
            function func1(){
                var command=window.location.href;
                command=command.split('?');
                if(command.length==2){
                    command=command[1];
                    command=command.split('&');
                    for(var i=0;i<command.length;i++){
                        var href=command[i].split('=');
                        if(href.length==1||href.length==0) continue;
                        if(href[0]=='DarkMode'){
                            if(href[1]=='true') document.getElementById('body').style.color='white',document.getElementById('body').style.backgroundColor='black',SwapMode();
                            else document.getElementById('body').style.color='black',document.getElementById('body').style.backgroundColor='white';
                        }
                        else if(href[0]=='page'){
                            if(href[1]=='index') Now_Src="MainPage.html",SetURL();
                            else if(href[1]=='documents') Now_Src="documents.html",SetURL();
                            else if(href[1]=='about') Now_Src="about_us.html",SetURL();
                            else if(href[1]=='find') Now_Src="Search.html",SetURL();
                        }
                    }
                }
            }
        </script>
    </head>
    <body id="body" style="width:100%;height: 100%;" onload="func1()">
        <div class="menu" id="menu">
            <center><span style="font-size: 20px;">Excel</span></center>
            <div>
                <div style="width: 94%;height: 60px;position: absolute;left: 2px;border-style:solid;border-radius: 5px;"  onclick="window.open('index.html?DarkMode='+(DarkMode?'true':'false')+'&page=index','_self',window)"><center><i style="font-size: 50px" class="fa fa-home"><span id="Bar_Text1" style="font-size: 32px" class="hide">Home</span></i></center></div>
                <div style="width: 94%;height: 60px;position: absolute;left: 2px;top: 90px;border-style:solid;border-radius: 5px;"  onclick="window.open('index.html?DarkMode='+(DarkMode?'true':'false')+'&page=documents','_self',window)"><center><i style="font-size: 50px" class="fa fa-file-text"><span id="Bar_Text2" style="font-size: 32px" class="hide">Documents</span></i></center></div>
                <div style="width: 94%;height: 60px;position: absolute;left: 2px;top: 160px;border-style:solid;border-radius: 5px;" onclick="window.open('index.html?DarkMode='+(DarkMode?'true':'false')+'&page=about','_self',window)"><center><i style="font-size: 50px" class="fa fa-question-circle"><span id="Bar_Text3" style="font-size: 32px" class="hide">About</span></i></center></div>
                <div style="width: 94%;height: 60px;position: absolute;left: 2px;top: 230px;border-style:solid;border-radius: 5px;"  onclick="window.open('index.html?DarkMode='+(DarkMode?'true':'false')+'&page=find','_self',window)"><center><i style="font-size: 50px" class="fa fa-search"><span id="Bar_Text5" style="font-size: 32px" class="hide">Find</span></i></center></div>
                <!--以下是其他的小东西-->
                <span style="position: absolute;left: 2px;top: 300px">明暗：</span>
                <div style="width: 60px;height: 20px;position: absolute;left: 2px;top: 325px">
                    <div style="border-radius: 15px;border-style: solid;height:100%;width:48px;background-color:gainsboro" id="dark_mode_border" onclick="SwapMode()">
                        <div style="border-radius: 15px;border-style: solid;width:15px;height:16px;background-color:white;position: absolute;" id="dark_mode"></div>
                    </div>
                </div>
                <br>
                <div style="width: 60px;height: 60px;position: absolute;left: 2px;top: 360px"><center><a onclick="window.open('https://space.bilibili.com/1439352366')"><img src="https://www.bilibili.com/favicon.ico"></a></center></div>
                <br>
                <!--fa fa-close & fa fa-bars-->
                <div style="width: 60px;height: 60px;position:fixed;left:0px;bottom:0px" onclick="SwapSmile()"><center><i style="font-size: 50px;position: absolute;bottom: 0px;left:calc(50% - 22px)" class="fa fa-bars" id="Show"><span id="Bar_Text4" style="font-size: 32px;" class="hide">Close</span></i></center></div>
            </div>
        </div>
        <iframe id="Main" style="width: calc(100% - 61px);height: 100%;position:fixed;left:61px;top:0px" src="MainPage.html?DarkMode=false" onload="func1()"></iframe>
    </body>
</html>
