<!DOCTYPE html>
<html lang="zh-cn">
    <head>
        <title id="title">下载文件 - </title>
        <script src="WebCode\jquery.js"></script><!--引用jquery.js-->
        <link rel="stylesheet" href="https://cdn.staticfile.org/font-awesome/4.7.0/css/font-awesome.css"><!--使用图标库-->
        <script>
            /*************************
            ********JavaScript********
            *************************/
            var s=new String(location.search),a,t,file=new Array,downloadfile,filetype;
            var isexit=false;
            function init(){
                a=String(s).split('?');
                t=String(a[1]).split(";");
                for(var i=0;i<t.length;i++){
                    file=t[i].split("=");
                    if(file[0]=="df"){
                        downloadfile=file[1];
                        document.title="下载文件 - "+file[1];
                        filetype=file[1].split('.');
                        filetype=filetype[filetype.length-1];
                        if(filetype=="html"||filetype=="htm"||filetype=="e"||filetype=="cpp"||filetype=="c"||filetype=="java"||filetype=="js"||filetype=="css"||filetype=="vb"||filetype=="bat"||filetype=="vbs"||filetype=="cmd"||filetype=="py"||filetype=="jar"||filetype=="md"||filetype=="markdown"||filetype=="cs") document.getElementById('image').innerHTML="<i class=\"fa fa-file-code-o\" style=\"font-size:64px;position:absolute;top:2px;left:2px\"></i>";
                        else if(filetype=="png"||filetype=="jpg"||filetype=="jpeg"||filetype=="svg"||filetype=="ico"||filetype=="bmp"||filetype=="gif") document.getElementById('image').innerHTML="<i class=\"fa fa-file-image-o\" style=\"font-size:64px;position:absolute;top:2px;left:2px\"></i>";
                        else if(filetype=="mp4"||filetype=="mov") document.getElementById('image').innerHTML="<i class=\"fa fa-file-movie-o\" style=\"font-size:64px;position:absolute;top:2px;left:2px\"></i>";
                        else if(filetype=="mp3") document.getElementById('image').innerHTML="<i class=\"fa fa-file-audio-o\" style=\"font-size:64px;position:absolute;top:2px;left:2px\"></i>";
                        else if(filetype=="rar4"||filetype=="gz"||filetype=="7z"||filetype=="rar"||filetype=="zip") document.getElementById('image').innerHTML="<i class=\"fa fa-file-zip-o\" style=\"font-size:64px;position:absolute;top:2px;left:2px\"></i>";
                        else if(filetype=="inf"||filetype=="ini"||filetype=="txt"||filetype=="log") document.getElementById('image').innerHTML="<i class=\"fa fa-file-text-o\" style=\"font-size:64px;position:absolute;top:2px;left:2px\"></i>";
                        else if(filetype=="exe"||filetype=="com"||filetype=="pif") document.getElementById('image').innerHTML="<i class=\"fa fa-windows\" style=\"font-size:64px;position:absolute;top:2px;left:2px;color:blue\"></i>";
                        //判断后缀名并显示图标
                    }
                    else if(file[0]=="title") document.getElementById('Text').src=file[1];
                    else if(file[0]=="name") document.getElementById('Name').innerText=file[1];
                    else if(file[0]=="projectname") document.getElementById('File_ProjectName').innerText=file[1];
                    else if(file[0]=="updatetime") document.getElementById('File_UpdateTime').innerText=file[1];
                    else if(file[0]=="version") document.getElementById('version').innerText=file[1];
                    else if(file[0]=="document") document.getElementById('TEXT').src=file[1];
                    else if(file[0]=="maker") document.getElementById('maker').innerText=file[1];//网页参数判断
                    else{
                        $("#main").hide();
                        document.title="错误";
                        isexit=true;//说明有人乱搞
                    }
                }
                if(isexit){
                    alert('错误 404 资源不存在');//不让他访问
                    $('main').hide();
                    window.open('404.html');
                }
            }
        </script>
        <link rel="stylesheet" type="text/css" href="WebCode\main.css"><!--引用main.css-->
    </head>
    <body class="body" onload="init()">
        <div id="top" style="border-style:solid;border-color:black;border-width:1px;background-color:black;top:0%;height:40px;left:0%;position:fixed;width:100%">
			<img style="position:relative;left:0%;width:40px;height:40px" src="Icon.png">
			<span style="color:white;font-size:10px;position:relative;left:0;top:-15px">Office-Excel的个人网站</span>
			<a style="color:white;font-size:10px;position:relative;left:78%;top:-15px;" href="https://">作者的B站主页</a>
		</div>
        <div id="main" style="width:90%;left:5%;top:40px;position:fixed;border-color:black;border-style:solid;border-width:5px;height:90%;background-color:aquamarine">
            <div id="image" style="position:absolute;top:0px;left:0px;width:64px;height:64px;border-style: none;background-color:aquamarine"></div>
            <iframe frameborder="0" id="Text" class="codeorimg" style="background-color:aquamarine;color:white;position:absolute;top:0px;left:64px;height:64px;width:93.8%" onerror="alert('错误 404 文本不存在')"></iframe>
            <button style="font-size:70px;color:aqua;position:absolute;top:70px;left:0px" onclick="window.open(downloadfile)">下载 <i class="fa fa-download"></i></button>
            <!--<p id="Good" style="position:absolute;left:265px;top:30px;font-size:50px">0</p>
            <button style="position:absolute;left:250px;top:140px;font-size:50px"><i class="fa fa-thumbs-o-up"></i></button>
            <p id="Bad" style="position:absolute;left:485px;top:30px;font-size:50px">0</p>
            <button style="position:absolute;left:470px;top:140px;font-size:50px"><i class="fa fa-thumbs-o-down"></i></button>
            <p id="Star" style="position:absolute;left:715px;top:30px;font-size:50px">0</p>这里是赞、收藏、不喜欢的按钮
            <button style="position:absolute;left:700px;top:140px;font-size:50px"><i class="fa fa-star-o"></i></button>-->
            <!--不会做上面的-->
            <table border="1" style="top:70px;left:250px;width:75%;position:absolute">
                <tr><th>值</th><th>值内容</th></tr>
                <tr><td>名称：</td><td id="Name"></td></tr>
                <tr>
                    <td>项目名称：</td>
                    <td id="File_ProjectName"></td>
                </tr>
                <tr>
                    <td>最新发布时间：</td>
                    <td id="File_UpdateTime"></td>
                </tr>
                <tr>
                    <td>最新版本：</td>
                    <td id="version"></td>
                </tr>
                <tr>
                    <td>作者：</td>
                    <td id="maker"></td>
                </tr>
            </table><!--表格-->
            <em style="position:absolute;left:0px;top:170px;font-size:35px">文档：</em>
            <iframe frameborder="0" style="position:absolute;top:220px;left:1px;width:100%;height:329px;" id="TEXT"></iframe>
        </div>
    </body>
</html>